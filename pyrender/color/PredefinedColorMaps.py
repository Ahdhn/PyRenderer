import numpy as np
from bisect import bisect
def hex2rgb(c, alpha=1.0):
    c = c.lstrip("#");
    assert(len(c) == 6);
    return [int(c[0:2], 16) / 255.0,
            int(c[2:4], 16) / 255.0,
            int(c[4:6], 16) / 255.0,
            alpha];

def int2rgb(c, alpha=1.0):
    assert(len(c) == 3);
    return [c[0]/255.0, c[1]/255.0, c[2]/255.0, alpha];

color_maps = {
        "stress":{
            0.0:  hex2rgb("#000077"),
            0.5:  hex2rgb("#0000FF"),
            0.75: hex2rgb("#0099FF"),
            0.90: hex2rgb("#FFFF00"),
            0.95: hex2rgb("#FF6600"),
            0.99: hex2rgb("#FF3300"),
            },
        "fifty_percent":{
            0.5:  hex2rgb("#000077"),
            0.6:  hex2rgb("#0000FF"),
            0.7:  hex2rgb("#0099FF"),
            0.8:  hex2rgb("#FFFF00"),
            0.9:  hex2rgb("#FF6600"),
            0.99: hex2rgb("#FF3300"),
            },
        "combined_weakness": {
            0.81: hex2rgb("#005AC3"),
            0.87: hex2rgb("#61CF4D"),
            0.93: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "ninety_percent": {
            0.90: hex2rgb("#005AC3"),
            0.93: hex2rgb("#61CF4D"),
            0.96: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "ninety_seven_percent": {
            0.97: hex2rgb("#005AC3"),
            0.98: hex2rgb("#61CF4D"),
            0.99: hex2rgb("#FFF414"),
            0.999: hex2rgb("#CA0300"),
            },
        "stress_vs_trace": {
            0.90: hex2rgb("#005AC3"),
            0.93: hex2rgb("#61CF4D"),
            0.96: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "droptest_lower": {
            0.84: hex2rgb("#005AC3"),
            0.89: hex2rgb("#61CF4D"),
            0.94: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "droptest": {
            0.90: hex2rgb("#005AC3"),
            0.93: hex2rgb("#61CF4D"),
            0.96: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "droptest_squash": {
            0.90: hex2rgb("#005AC3"),
            0.95: hex2rgb("#61CF4D"),
            0.98: hex2rgb("#FFF414"),
            1.00: hex2rgb("#CA0300"),
            },
        "droptest_higher": {
            0.93: hex2rgb("#005AC3"),
            0.95: hex2rgb("#61CF4D"),
            0.97: hex2rgb("#FFF414"),
            0.99: hex2rgb("#CA0300"),
            },
        "droptest_higher_squash": {
            0.93: hex2rgb("#005AC3"),
            0.96: hex2rgb("#61CF4D"),
            0.99: hex2rgb("#FFF414"),
            1.00: hex2rgb("#CA0300"),
            },
        "region": {
            0.1: hex2rgb("#124EB1"),
            0.9: hex2rgb("#FFE900"),
            },
        "two_regions": {
            0.1: hex2rgb("#124EB1"),
            0.4: hex2rgb("#FFE900"),
            0.6: hex2rgb("#FFE900"),
            0.9: hex2rgb("#CB1E0E")
            },
        "three_regions": {
            0.1: hex2rgb("#124EB1"),
            0.3: hex2rgb("#FFE900"),
            0.4: hex2rgb("#FFE900"),
            0.5: hex2rgb("#CB1E0E"),
            0.6: hex2rgb("#CB1E0E"),
            0.9: hex2rgb("#518F27")
            },
        "jet": {
            0.1: hex2rgb("#00007F"),
            0.2: hex2rgb("#0000FF"),
            0.3: hex2rgb("#007FFF"),
            0.4: hex2rgb("#00FFFF"),
            0.5: hex2rgb("#7FFF7F"),
            0.6: hex2rgb("#FFFF00"),
            0.7: hex2rgb("#FF7F00"),
            0.8: hex2rgb("#FF0000"),
            0.9: hex2rgb("#7F0000"),
            },
        "fireprint": {
                 0: (     0,      0,      0, 1.0),
            0.0526: (     0, 0.0456, 0.0790, 1.0),
            0.1053: (     0, 0.0912, 0.1580, 1.0),
            0.1579: (     0, 0.1367, 0.2371, 1.0),
            0.2105: (     0, 0.1823, 0.3161, 1.0),
            0.2632: (0.0167, 0.2274, 0.3950, 1.0),
            0.3158: (0.1158, 0.2647, 0.4649, 1.0),
            0.3684: (0.2690, 0.2803, 0.5070, 1.0),
            0.4211: (0.4673, 0.2501, 0.5018, 1.0),
            0.4737: (0.6715, 0.1700, 0.4400, 1.0),
            0.5263: (0.8127, 0.2061, 0.3579, 1.0),
            0.5789: (0.8868, 0.3779, 0.2762, 1.0),
            0.6316: (0.9268, 0.5487, 0.1915, 1.0),
            0.6842: (0.9404, 0.7134, 0.1059, 1.0),
            0.7368: (0.9376, 0.8659, 0.0210, 1.0),
            0.7895: (0.9853, 0.9351, 0.1573, 1.0),
            0.8421: (0.9985, 0.9715, 0.4324, 1.0),
            0.8947: (0.9980, 0.9954, 0.6462, 1.0),
            0.9474: (0.9962, 0.9976, 0.8431, 1.0),
            1.0000: (1.0000, 1.0000, 1.0000, 1.0)
            },
        "jet_matlab": {
                0     : (     0,      0, 0.6000, 1.0),
                0.0526: (     0,      0, 0.8000, 1.0),
                0.1053: (     0,      0, 1.0000, 1.0),
                0.1579: (     0, 0.2000, 1.0000, 1.0),
                0.2105: (     0, 0.4000, 1.0000, 1.0),
                0.2632: (     0, 0.6000, 1.0000, 1.0),
                0.3158: (     0, 0.8000, 1.0000, 1.0),
                0.3684: (     0, 1.0000, 1.0000, 1.0),
                0.4211: (0.2000, 1.0000, 0.8000, 1.0),
                0.4737: (0.4000, 1.0000, 0.6000, 1.0),
                0.5263: (0.6000, 1.0000, 0.4000, 1.0),
                0.5789: (0.8000, 1.0000, 0.2000, 1.0),
                0.6316: (1.0000, 1.0000,      0, 1.0),
                0.6842: (1.0000, 0.8000,      0, 1.0),
                0.7368: (1.0000, 0.6000,      0, 1.0),
                0.7895: (1.0000, 0.4000,      0, 1.0),
                0.8421: (1.0000, 0.2000,      0, 1.0),
                0.8947: (1.0000,      0,      0, 1.0),
                0.9474: (0.8000,      0,      0, 1.0),
                1.0000: (0.6000,      0,      0, 1.0)
                },
        "discrete": {
                0.0: hex2rgb("#FCFFD9"),
                0.1: hex2rgb("#5977E9"),
                0.2: hex2rgb("#FF8649"),
                0.3: hex2rgb("#56B4E9"),
                0.4: hex2rgb("#B2F673"),
                0.5: hex2rgb("#FF6F69"),
                0.6: hex2rgb("#96CEB4"),
                0.7: hex2rgb("#FFCC5C"),
                0.8: hex2rgb("#AAD8B0"),
                0.9: hex2rgb("#36362C"),
                1.0: hex2rgb("#DDDDDD")
                },
        "warm": {
                0.0: hex2rgb("#FFE870"),
                1.0: hex2rgb("#ED3225"),
                },
        "YlOrRd": {
                0.0: hex2rgb("#FFFECC"),
                0.5: hex2rgb("#FF8F31"),
                1.0: hex2rgb("#87101C"),
                },
        "RdYlGn": {
                0.0: hex2rgb("#AD1718"),
                0.5: hex2rgb("#FFFDBF"),
                1.0: hex2rgb("#006734"),
                },
        # This color map is the "RdYlBu" from http://colorbrewer2.org
        "RdYlBu": {
                0.1: hex2rgb("#d7191c"),
                0.3: hex2rgb("#fdae61"),
                0.5: hex2rgb("#ffffbf"),
                0.7: hex2rgb("#abd9e9"),
                0.9: hex2rgb("#2c7bb6"),
                },
        "BuYlRd": {
                0.1: hex2rgb("#2c7bb6"),
                0.3: hex2rgb("#abd9e9"),
                0.5: hex2rgb("#ffffbf"),
                0.7: hex2rgb("#fdae61"),
                0.9: hex2rgb("#d7191c"),
                },
        # The following color map are from the paper
        # http://www.sandia.gov/~kmorel/documents/ColorMaps/ColorMapsExpanded.pdf
        "cool_warm": {
                0.0    : int2rgb([ 59,  76, 192]),
                0.03125: int2rgb([ 68,  90, 204]),
                0.0625 : int2rgb([ 77, 104, 215]),
                0.09375: int2rgb([ 87, 117, 225]),
                0.125  : int2rgb([ 98, 130, 234]),
                0.15625: int2rgb([108, 142, 241]),
                0.1875 : int2rgb([119, 154, 247]),
                0.21875: int2rgb([130, 165, 251]),
                0.25   : int2rgb([141, 176, 254]),
                0.28125: int2rgb([152, 185, 255]),
                0.3125 : int2rgb([163, 194, 255]),
                0.34375: int2rgb([174, 201, 253]),
                0.375  : int2rgb([184, 208, 249]),
                0.40625: int2rgb([194, 213, 244]),
                0.4375 : int2rgb([204, 217, 238]),
                0.46875: int2rgb([213, 219, 230]),
                0.5    : int2rgb([221, 221, 221]),
                0.53125: int2rgb([229, 216, 209]),
                0.5625 : int2rgb([236, 221, 197]),
                0.59375: int2rgb([241, 204, 185]),
                0.625  : int2rgb([245, 196, 173]),
                0.65625: int2rgb([247, 187, 160]),
                0.6875 : int2rgb([247, 177, 148]),
                0.71875: int2rgb([247, 166, 135]),
                0.75   : int2rgb([244, 154, 123]),
                0.78125: int2rgb([241, 141, 111]),
                0.8125 : int2rgb([236, 127,  99]),
                0.84375: int2rgb([229, 121,  88]),
                0.875  : int2rgb([222,  96,  77]),
                0.90625: int2rgb([213,  80,  66]),
                0.9375 : int2rgb([203,  62,  56]),
                0.96875: int2rgb([192,  40,  47]),
                1.0    : int2rgb([180,   4,  38]),
                },
        # The following are sampled from Matlab Parula color map.
        # http://www.alecjacobson.com/weblog/?tag=parula
        "parula": {
                0.0000: hex2rgb("#2D3785"),
                0.0667: hex2rgb("#2854BA"),
                0.1333: hex2rgb("#0D71DE"),
                0.1333: hex2rgb("#0D71DE"),
                0.2000: hex2rgb("#277FD8"),
                0.2667: hex2rgb("#368CD0"),
                0.3333: hex2rgb("#419DCC"),
                0.4000: hex2rgb("#4CA8BE"),
                0.4667: hex2rgb("#58B0AA"),
                0.5333: hex2rgb("#6DB692"),
                0.6000: hex2rgb("#8DB97C"),
                0.6667: hex2rgb("#ACB96D"),
                0.7333: hex2rgb("#C9B762"),
                0.8000: hex2rgb("#E6B758"),
                0.8667: hex2rgb("#F7C448"),
                0.9333: hex2rgb("#F4D83C"),
                1.0000: hex2rgb("#FDF334"),
                },
        "contrast_yb": {
                0.000: hex2rgb("#EFE442"),
                1.000: hex2rgb("#57B4E9"),
                },
        "contrast_by": {
                0.000: hex2rgb("#57B4E9"),
                1.000: hex2rgb("#EFE442"),
                },
        "contrast_yr": {
                0.000: hex2rgb("#EFE442"),
                1.000: hex2rgb("#d7191c"),
                },
        "binary": {
                0.000: hex2rgb("#F28C58"),
                1.000: hex2rgb("#EFE442"),
                },
        "binary_reverse": {
                0.000: hex2rgb("#EFE442"),
                1.000: hex2rgb("#F28C58"),
                },
        "discrete_3": {
                0.000: hex2rgb("#F28C58"),
                0.500: hex2rgb("#EFE442"),
                1.000: hex2rgb("#99D594"),
                },
        "discrete_4": {
                0.000: hex2rgb("#F28C58"),
                0.333: hex2rgb("#EFE442"),
                0.666: hex2rgb("#99D594"),
                1.000: hex2rgb("#57B4E9"),
                },
        };


